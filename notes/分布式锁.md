#### 分布式锁
> 程序需要先获取锁，获取对数据进行排他访问性的能力，然后对数据进行一些列的操作，最终要释放锁。Redis使用Watch
> 对数据进行加锁，watch只会在数据被其他的客户端抢先修改了的情况下通知执行这个命令的客户端，而不是组织其他的客户端
> 对数据修改，所以这个命令被称为`乐观锁`

##### redis一些导致锁出现不正确行为的原因
1. 持有锁的进程操作时间过长，导致锁被自动释放，但是进程本身不清楚这件事情，甚至可能错误的释放掉其他进程持有的锁
2. 持有锁的进程已经崩溃，但是其他想要获取锁的进程不清楚那个进程持有锁，导致浪费等待时间。
3. 一个进程持有锁，其他的进程去获取锁，并且都获取到了。


#### redis利用setnx实现锁
> 对每个key用setnx设置一个uuid，释放的时候删除key。

